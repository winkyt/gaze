<!DOCTYPE html>
<html lang="en">
<head>
	<title>Stand with #StandingRock</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Stand with #StandingRock" />
	<meta property="og:url" content="https://winkyt.github.io/standwithstandingrock" />
	<meta property="og:image" content="img/screen.png" />
	<meta property="og:description" content="The Dakota Access Pipeline Protest(#NoDAPL) began in early 2016 in reaction to the approved construction of Energy Transfer Partners' Dakota Access Pipeline in the northern United States. The pipeline pass through the Lake Oahe near the Standing Rock Indian Reservation. Early in October 31 2016, a Facebook post said that the Morton County sheriff’s department was using Facebook check-ins to target people at the protest camp. People answered the call on Facebook to ‘overwhelm and confuse’ law enforcement officials, although police denied tracking activists on social media." />
	<!--stylesheets-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
	<link href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.35.1/mapbox-gl.css" rel='stylesheet' />
	<link rel="stylesheet" href="https://turban.github.io/Leaflet.Photo/examples/lib/cluster/MarkerCluster.css" />
	<link rel="stylesheet" href="https://turban.github.io/Leaflet.Photo/Leaflet.Photo.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
	<link rel="stylesheet" type="text/css" href="css/storymap.css">
	<link rel="stylesheet" href="css/main.css" />

	<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Courgette|Inconsolata|Titillium+Web|Fira+Sans+Condensed" />
	<!--Bootstrap-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<!--leaflet-->
	<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
	<!--<script src="https://cdn.rawgit.com/teastman/Leaflet.pattern/44c56780/dist/leaflet.pattern-src.js"></script>-->
	<script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.35.1/mapbox-gl.js"></script>
	<script src="https://rawgit.com/mapbox/mapbox-gl-leaflet/master/leaflet-mapbox-gl.js"></script>
	<script src="js/leaflet.markercluster-src.js"></script>
	<script src="https://turban.github.io/Leaflet.Photo/Leaflet.Photo.js"></script>

	<script src="https://d3js.org/d3.v4.min.js"></script>

	<script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
	<script src="js/leaflet-d3.js"></script>
	<!--<script src="https://cdn.bootcss.com/chroma-js/1.3.3/chroma.min.js"></script>-->
	<script src="js/colorbrewer.js"></script>

	<!-- mini globle map -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
	<script src="js/globeminimap.js"></script>
	<script src="js/storymap.js"></script>

	<script src="js/jqcloud.js"></script>
	<script src="assets/data.js"></script>
	<script src="assets/post-contents.js"></script>
</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top navbar-toggleable-md" role="navigation">
	<div class="container-fluid" >
		<a class="navbar-brand" href="#">
			<img src="img/favicon.ico" class="align-top" height="20px" align="left"> &nbsp;
		</a>
		<div class="navbar-header">
			<a class="navbar-brand" href="#">Stand with #StandingRock</a>
		</div>

		<div class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="javascript:window.scrollBy(0,$('section[data-scene=overview]').offset().top-$(window).scrollTop()-40);">Home</a>
				</li>
				<li>
					<a href="javascript:window.scrollBy(0,$('section[data-scene=checkin]').offset().top-$(window).scrollTop()-40);">Info</a>
				</li>
				<li>
					<a href="javascript:window.scrollBy(0,$('section[data-scene=map_intro]').offset().top-$(window).scrollTop()-40);">StandingRock</a>
				</li>
				<li>
					<a href="javascript:window.scrollBy(0,$('section[data-scene=map_pipeline]').offset().top-$(window).scrollTop()-40);">Pipeline</a>
				</li>
				<li>
					<a href="javascript:window.scrollBy(0,$('section[data-scene=map_camp]').offset().top-$(window).scrollTop()-40);">Camps</a>
				</li>
				<li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Check-in<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li>
							<a href="javascript:window.scrollBy(0,$('section[data-scene=map_hex]').offset().top-$(window).scrollTop()-40);">Spoofed Check-ins</a>
						</li>
						<li>
							<a href="javascript:window.scrollBy(0,$('section[data-scene=map_hex_case1]').offset().top-$(window).scrollTop()-40);">Why Spoofing?</a>
						</li>
						<li>
							<a href="javascript:window.scrollBy(0,$('section[data-scene=map_hex_case2]').offset().top-$(window).scrollTop()-40);">Spatial and Semantic Explore</a>
						</li>
					</ul>
				</li>
				<li>
					<a class="fa fa-info-circle social"  href="about.html" target="_blank"></a>
					<!--<a class="fa fa-info-circle social" data-toggle="modal" data-target="#info-modal" href="about.html"></a>-->
				</li>
				<li>
					<a class="fa fa-facebook-square social" href="https://facebook.com/sharer.php?u=https://winkyt.github.io/standwithstandingrock" target="_blank"></a>
				</li>
				<li>
					<a class="fa fa-twitter-square social" href="https://twitter.com/home?status=Location%20Spoofing%20at%20StandingRock%0Ahttps://winkyt.github.io/standwithstandingrock" target="_blank"></a>
				</li>
				<li>
					<a class="fa fa-github-square social2"  href="https://github.com/winkyt/standwithstandingrock" target="_blank"></a>
				</li>
			</ul>
		</div>
	</div>
</div>

<div class="container-fluid">
	<div class="row">
		<div class="col-sm-6 col-md-4 main">

			<section data-scene="overview">
				<div class= "overview-background-img background-fullscreen-setting text-responsive">
					<h1>Stand with #StandingRock</h1>
					<h2 class="overview">
						The Dakota Access Pipeline Protest (#NoDAPL) began in early 2016 in reaction to the approved construction of Energy Transfer Partners' Dakota Access Pipeline near the Standing Rock Indian Reservation. <br/><br/> Local native American and environmentalists were gathered at both Standing Rock and #StandingRock on Facebook to express their deep concerns.
					</h2>
					<br/>
					<div class="credit">
						<p><img style="width:180px;" align="right" src="img/grouplogo.png"></p> <br/><br/><br/>
						<p>Created by Yuanyuan Tian, Yingqi Tang From Oregon State University</p>
					</div>
				</div>
				<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
			</section>

			<section data-scene="checkin">
				<div class= "checkin-background-img background-fullscreen-setting text-responsive">
					<div class="container">
						<div class="row text-center index-icon">
							<div class="col-md-3 col-sm-3">
									<span class="fa-stack fa-4x">
										<i class="fa fa-map-marker fa-stack-2x text-primary"></i>
									</span>
								<h4>
									Location
								</h4>
								<p class="description">Standing Rock</p>
							</div>
							<div class="col-md-3 col-sm-3">
									<span class="fa-stack fa-4x">
										<i class="fa fa-user fa-stack-2x text-primary"></i>
									</span>
								<h4>
									Population
								</h4>
								<p class="description">8,217</p>
							</div>
							<div class="col-md-3 col-sm-3">
									<span class="fa-stack fa-4x">
									<i class="fa fa-male fa-stack-2x text-primary"></i>
									</span>
								<h4>
									Native American Pop.
								</h4>
								<p class="description">6,414</p>
							</div>
							<div class="col-md-3 col-sm-3">
									<span class="fa-stack fa-4x">
										<i class="fa fa-facebook fa-stack-2x text-primary"></i>
									</span>
								<h4>
									Check-in
								</h4>
								<p class="description">337,589</p>
							</div>
						</div>
						<h4 class="text-center">Above are basic information about Standing Rock.</h4>
						<div class="text-center linechart"></div>
						<h4 class="text-center">According to Google Trends, the term "Standing Rock" was frequently searched on Google Search engine starting from November 2016.</h4>
					</div>
				</div>
				<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
			</section>

			<section data-scene="map_intro" >
				<h3>Standing Rock</h3>
				<p> Located in North Dakota (ND) and South Dakota (SD), The Standing Rock Indian Reservation is occupied by ethnic Hunkpapa Lakota, Sihasapa Lakota and Yanktonai Dakota, it includes Sioux County, ND, Corson County, SD, plus slivers of northern Dewey and Ziebach, SD, along their northern county lines at Highway 20. Standing Rock ranks the sixth largest Native American reservation in land area of U.S.
				</p>
				<div class="legend legend-custom">
					<i style="background: orange"></i><p>Reservation Land</p><br/>
				</div>
				<div class="embeded-photo img-responsive"></div>
				<i class="animated zoomIn infinite glyphicon glyphicon-menu-down arrow-down"></i>
			</section>

			<section data-scene="map_pipeline">
				<h3>The Proposed Pipeline</h3>
				<!--<p>The pipeline is is designed to transport as many as 570,000 barrels of crude oil daily from North Dakota to Illinois. The pipeline would be a key conduit connecting oil wells in the state's Bakken Shale, where the development of fracking has opened billions of gallons of new oil to recovery, to other valuable consumer markets, including the Gulf Coast, Midwest and East Coast. The nearly $4 billion project was first proposed in 2014 with an anticipated completion of this year.</p>-->
				<p>The pipeline is to be built by Texas-based Energy Transfer Partners and is designed to transport as many

					as 570,000 barrels of crude oil daily from North Dakota to Illinois. This Pipeline has drawn parallels to

					the Keystone XL pipeline. Opposition to that project, which Obama eventually rejected, became a litmus

					test in the eyes of some activists for public officials to show their commitment to addressing

					environmental issues. But at the same time significant differences remain. Perhaps most importantly,

					Keystone crossed into Canada, making it an international issue that gave authority over its final approval

					to the State Department. The federal government has the authority over the Dakota Access Pipeline

					because it crosses interstate waterways. Stopping the project would be challenging for any administration.<br/><br/>

					The protest was caused by issues related to the protection of water, land, and religious/spiritual sites

					sacred to indigenous peoples of the Americas. Despite the U.S. Army Corps of Engineers claim that the

					pipeline will not cross the Standing Rock area, people still worry that a leak from the pipeline could

					contaminate local water sources and damage local agriculture. We must ask: which is more important,

					water and food security, or energy security?
				</p>

				<div class="legend legend-custom">
					<i style="background: #ABD1E8;"></i><p>Aquifer</p><br/>
					<i style="background: #006080; opacity: 0.5"></i><p>River</p><br/>
					<i style="background: orange"></i><p>Reservation Land</p><br/>
					<i style="background: #B51E1E;"></i><p>Pipeline</p><br/>
				</div>
				<div class="embeded-photo img-responsive"></div>
			</section>

			<section data-scene="map_camp">
				<h3>Protest Camp</h3>
				<p>In April, Standing Rock Sioux elder LaDonna Brave Bull Allard established Sacred Stone camp as a

					center for cultural preservation and spiritual resistance to the pipeline. Over the summer the camp

					grew to thousands of people. Later, two more camps were established at the area. People gathered

					at the camps to show their support.</p>
				<div class="legend legend-custom">

					<i class="glyphicon glyphicon-tent camp-icon-2 point-legend"></i> <p> <b>The Sacred Stone Camp</b> was erected since April 2016 and grew dramatically in its scape. It has played a major role in protecting the site.</p> <br/>

					<i class="glyphicon glyphicon-tent camp-icon-1 point-legend"></i><p> <b>The Oceti Sakowin Camp</b> is a historic gathering of native tribes. This camp is a world stage for environmental awareness and will act as a future indigenous meeting center. </p> <br/>

					<i class="glyphicon glyphicon-tent camp-icon-3 point-legend"></i><p> <b>The Frontline Camp</b> was erected in path of the Dakota Access Pipeline. </p> <br/>

					<i style="background: #ABD1E8;"></i><p>Aquifer</p><br/>
					<i style="background: #006080; opacity: 0.5"></i><p>River</p><br/>
					<i style="background: orange"></i><p>Reservation Land</p><br/>
					<i style="background: #B51E1E;"></i><p>Pipeline</p><br/>
				</div>
				<div class="embeded-photo img-responsive"></div>
			</section>

			<section data-scene="map_hex">
				<h3>Spoofed Check-in</h3>
				<p>In response to a viral post claiming that doing so would help protect activists in North Dakota protesting against an oil pipeline from police surveillance More than 1 million people have checked in on Facebook to the Standing Rock Indian reservation in response to a viral post claiming that doing so would help protect activists in North Dakota protesting against an oil pipeline from police surveillance.</p> <br/> <br/>
				<video controls width="500px" class="embeded-photo">
					<source src="assets/youtube.mp4" />
				</video>
				<br/><br/><p>Why Thousands Are Facebook "Checking In" At Standing Rock, ND from <a href="https://youtu.be/Xu5Mz17t0IA">Youtube</a>.</p>
			</section>

			<section data-scene="map_hex_case1">
				<h3>Why Spoofing?</h3>
				<p> Why did Facebook users spoof their check-ins? <br/>Hover on the Facebook icon to get some clues.<br/><br/></p>
                <!--<div class="tooltipdiv redspan" style="background-color: white" >
                    <img src=img/userthumbnail1.png> <a>Alice Mosle</a> <br/>Monday, October 31, 2016 at 7:33am <br/>
                    <p>I am <span>standing virtually</span>. "The Morton County Sheriff's Department has been using Facebook check-ins to find out who is at Standing Rock in order to target them in attempts to disrupt the prayer camps. So Water Protectors are <span>calling on EVERYONE to check-in</span> at Standing Rock, ND to <span>overwhelm and confuse</span> them...</p>
                </div>
                <div class="tooltipdiv redspan" style="background-color: white" >
                    <img src=img/userthumbnail3.png> <a>Mike F Shaw</a> <br/>Monday, October 31, 2016 at 8:52am <br/>
                    <p>EVERYONE</span> DO THIS NOW!! Friends, solidarity needed here for protectors at Standing Rock...SO Water Protecters are <span>calling on EVERYONE to check-in</span> at Standing Rock, ND ...do <span>without leaving our homes</span>. Will you join me in Standing Rock?</p>
                </div>
                <div class="tooltipdiv redspan" style="background-color: white" >
                    <img src=img/userthumbnail2.png> <a>Christopher Corbin</a> <br/>Sunday, October 30, 2016 at 11:14pm <br/>
                    <p>I'm here...<span>in spirit</span>. [not actually in ND] ... Will you join me in Standing Rock? #NoDAPL</p><br/>
                </div>-->
                <iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fsctostandingrock%2Fposts%2F1686286628352162&width=500" width="500" height="562" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>
                <iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fchristopher.corbin.98%2Fposts%2F10210938765604885&width=500" width="500" height="639" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>
                <iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fmikefshaw%2Fposts%2F1465050350177443&width=500" width="500" height="620" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>


            </section>

			<section data-scene="map_hex_case2">
				<p>To understand the context of spoofed check-ins at Standing Rock, we crawled 1,858 spoofed check-ins. The word cloud illustrates all the relevant topics around the keyword "Standing Rock", and the map shows the spatial distribution of all spoofed check-ins.
				</p>
				<div class="legend legend-custom">
					<p><span style="position:absolute; left:0px"># Check-in per Hexagon: low</span>
						<i style="background: rgb(255,255,178);margin-right: 0px; position:absolute; left:220px"></i>
						<i style="background: rgb(254,204,92);margin-right: 0px; position:absolute; left:238px"></i>
						<i style="background: rgb(253,141,60);margin-right: 0px; position:absolute; left:256px"></i>
						<i style="background: rgb(240,59,32);margin-right: 0px; position:absolute; left:274px"></i>
						<i style="background: rgb(189,0,38);margin-right: 0px; position:absolute; left:292px"></i>
						<span style="position:absolute; left:316px" >high</span></p>
				</div>
				<br/> <br/>
				<div id="cloud" />
			</section>

			<section data-scene="end">
				<div class= "end-background-img background-fullscreen-setting text-responsive">
					<p class ="end">
						Due to the fierce local conflict triggered by the proposed pipeline, environmental protesters were forced to leave their camping area at the Standing Rock. Today, it has become nearly impossible for people to access the former camping area. Even though, an increasing number of social media users still stand with #StandingRock via spoofing their check-ins on Facebook.</p>
					<div class="credit">
						<p><img style="width:180px;" align="right" src="img/grouplogo.png"></p> <br/><br/><br/>
						<p>Created by Yuanyuan Tian, Yingqi Tang From Oregon State University</p>
					</div>
				</div>
			</section>
		</div>
		<div id="map" class="col-sm-6 col-md-8 sidebar"></div>
	</div>
	<i class="animated zoomIn infinite glyphicon glyphicon-menu-down arrow-down arrow-down-custom2"></i>
	<div class="progress-line"></div>
	<ul class="navwidget text-center"></ul>

	<!--<div class="modal fade" id="info-modal" role="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h2 class="modal-title text-center">About</h2>
				</div>
				<div class="modal-body">
					<p>This is a dynamic story map that discusses spoofing check-ins on Facebook related to the Dakota Access Pipeline Protest(#NoDAPL). The pipeline pass through the Lake Oahe near the Standing Rock Indian Reservation. Early in October 31 2016, a Facebook post said that the Morton County sheriff’s department was using Facebook check-ins to target people at the protest camps. People answered the call on Facebook to ‘overwhelm and confuse’ law enforcement officials, although police denied tracking activists on social media.</p><br/>

					<p><b>Geographic Data</b></p><br>
					<p>standing rock area | <a href = " " target="_blank">CEOAS GIS course database</a></p><br>
					<p>aquifer | <a href = "https://github.com/nittyjee/bakkenpipelinemap/blob/master/Mapping_Data/Standing_Rock_Reservation_Full.zip" target="_blank">bakkenpipelinemap</a></p><br>
					<p>pipeline | <a href = "https://www.jenniferveilleux.com/maps" target="_blank">Dr.Jennifer Veilleux</a></p><br>
					<p>camps | <a href = "https://www.huffingtonpost.com/entry/a-nodapl-map_us_581a0623e4b014443087af35" target="_blank">Carl Sack, cartographer </a>| UW Madison</p><br>

					<p><b>Context</b></p><br>
					<p>Argus Leader, CNN, Democracy Now, The Washington Post, The Guardian, Stand with Standing Rock, and Wikipedia.</p><br/>

					<p><b>Photos</b></p><br>
					<p><a href="https://www.jenniferveilleux.com/">Dr.Jennifer Veilleux</a> | Florida International University</p><br/>

					<p><b>Graphic Data</b></p><br>
					<p><a href="https://trends.google.com/trends/explore?q=standing%20rock">Google Trends</a></p><br/><br/>

					<p><b>Authors: </b></br>
						<a href = "https://github.com/CindyTYY" target="_blank">Yuanyuan Tian</a> | College of Earth, Ocean, Atmospheric Science | Oregon State University <br/>
						<a href = "https://github.com/winkyt" target="_blank">Yingqi Tang</a> | College of Earth, Ocean, Atmospheric Science | Oregon State University </p><br/>
					<p><b>Advisor: </b></br>
						<a href = "https://github.com/jakobzhao" target="_blank">Bo Zhao</a> | College of Earth, Ocean, Atmospheric Science | Oregon State University </p><br/><br/>

					<p><b>storymap.js</b> | Released Date: 03/17/2017 | Version: 2.25</p><br/>
					<p><b>Leaflet</b> | Released Date: 01/23/2017 | Version: 1.0.3</p><br/>

				</div>
			</div>
		</div>
	</div>-->

</div>

<script type="text/javascript">

    //making word cloud

    function wordFrequency(txt){

        var wordArray = txt.split(/[ .?!,*'"]/);
        var newArray = [], wordObj;
        wordArray.forEach(function (word) {
            wordObj = newArray.filter(function (w){
                return w.text == word;
            });
            if (wordObj.length) {
                wordObj[0].weight += 1;
            } else {
                newArray.push({text: word, weight: 1});
            }
        });
        return newArray;
    }


    var frequency_list = wordFrequency(postcontents);
    $('#cloud').jQCloud('destroy');
    $('#cloud').jQCloud(frequency_list,{
//      shape: 'rectangular',
//		colors: ['#b2182b','#d6604d','#f4a582','#542788','#8073ac','#b2abd2','#92c5de','#4393c3','#2166ac']
        colors: ['rgba(0, 0, 0, 0.7)']
    });


    // making linechart
    var margin = {top: 20, right: 20, bottom: 30, left: 50},
        width = 900 - margin.left - margin.right,
        height = 320 - margin.top - margin.bottom;

    //parse data from file
    var parseDate = d3.time.format("%m/%d/%y").parse;

    //set scales
    var x = d3.time.scale()
        .range([0, width]);

    var y = d3.scale.linear()
        .range([height, 0]);

    //create axes
    var xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom");

    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left");

    //construct the line using points from data
    var line = d3.svg.line()
        .x(function(d) { return x(d.date); })
        .y(function(d) { return y(d.users); });

    var svg = d3.select(".linechart").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    d3.csv("assets/trend.csv", function(error, data) {
        if (error) throw error;
//traverse through the data
        data.forEach(function(d) {
            d.date = parseDate(d.date);
            d.users = +d.users;
        });
//establish the domain for x and y axes
        x.domain(d3.extent(data, function(d) { return d.date; }));
        y.domain(d3.extent(data, function(d) { return d.users; }));

//add "groups"
        svg.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis);

        svg.append("g")
            .attr("class", "y axis")
            .call(yAxis)
            .append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", 6)
            .attr("dy", ".71em")
            .style("text-anchor", "end")
            .text("# Google Search");

        svg.append("path")
            .datum(data)
            .attr("class", "line")
            .attr("d", line);
    });



    var checkin_marker = L.marker([46.414719, -100.615682],  { icon: L.divIcon({className: 'animated fadeIn infinite fa fa-facebook marker-icon'})});

    checkin_marker.bindTooltip("#StandingRock",{sticky: false, className: "checkin-label",permanent: true, offset: [230, 4]});

    var SR_marker1 = L.marker([45.65, -99.8],
        { opacity: 0 }); //opacity may be set to zero
    SR_marker1.bindTooltip("Standing Rock<br/> Indian Reservation", {
        permanent: true,
        className: "sr-label1 text-center",
        offset: [0, 0],
    });
    var SR_marker2 = L.marker([46.35, -100.64],
        { opacity: 0 }); //opacity may be set to zero
    SR_marker2.bindTooltip("Standing Rock<br/> Indian Reservation", {
        permanent: true,
        className: "sr-label text-center",
        offset: [0, 0]
    });
    var SR_marker3 = L.marker([46.39, -100.64],
        { opacity: 0 }); //opacity may be set to zero
    SR_marker3.bindTooltip("Standing Rock<br/> Indian Reservation", {
        permanent: true,
        className: "sr-label text-center",
        offset: [0, 0]
    });

    var ND_marker1 = L.marker([46.53, -100.64],
        { opacity: 0 }); //opacity may be set to zero
    ND_marker1.bindTooltip("N &nbsp; o &nbsp; r &nbsp; t &nbsp; h &nbsp; &nbsp; D &nbsp; a &nbsp; k &nbsp; o &nbsp; t &nbsp; a", {
        permanent: true,
        className: "nd-label text-center",
        offset: [0, 0]
    });

    var camp_symbol = L.geoJson.ajax('assets/camp.geojson', {
        pointToLayer: function (feature, latlng) {
            delay = Math.floor((126 + latlng.lng) / 10 * 2000);
            //delay =Math.floor(Math.random() * 400);
            if (feature.properties.camp_nam === "Oceti Sakowin") {
                return L.marker(latlng, {bounceOnAdd: true,  bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'glyphicon glyphicon-tent camp-icon-1'})});
            } else if (feature.properties.camp_nam === "Sacred Stones Camp") {
                return L.marker(latlng, {bounceOnAdd: true,  bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'glyphicon glyphicon-tent camp-icon-2'})});
            } else if (feature.properties.camp_nam === "Frontline Camp") {
                return L.marker(latlng, {bounceOnAdd: true,  bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'glyphicon glyphicon-tent camp-icon-3'})});
            } else {
                return L.marker(latlng, {bounceOnAdd: true,  bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'glyphicon glyphicon-tent '})});
            }
        },
        onEachFeature: function (feature, layer) {
            layer.bindTooltip('<p><b>' + feature.properties.camp_nam+ '</b></p>', {sticky: false, className: "feature-label",permanent: false, offset: [-10, -145]});
        }
    });

    var fb_symbol = L.geoJson.ajax('assets/geofbposts_interest.geojson', {
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {bounceOnAdd: true,  opacity: 0.8, bounceOnAddOptions: {duration: 200, height: window.innerHeight, delay:delay}, icon: L.divIcon({className: 'fa fa-facebook fa-stack-2x facebook-color'})});
        },
        onEachFeature: function (feature, layer) {
            layer.bindTooltip('<div class="tooltipdiv redspan">' + '<img src="' + feature.properties.headshot + '"/>' + "   " +'<a>'+ feature.properties.user_name + '</a>' + "   " + '<br/>'+ feature.properties.time2 + '<br/>'+ " <br/>" + feature.properties.content + '</div>', {sticky: false, className: "feature-label",permanent: false});
        }
    });


    var options = {
        opacity: 0.9,
        radiusRange: [ 1, 10 ],
        duration: 200,
        colorScaleExtent: [ 1, undefined ],
        colorRange: colorbrewer["YlOrRd"][5],
        pointerEvents: 'auto'
    };
    var hexLayer = L.hexbinLayer(options);



    function generateData() {
        var data = [];
        for(var i = 0; i < fb.features.length; i++) {
            lng = fb.features[i].geometry.coordinates[1];
            lat = fb.features[i].geometry.coordinates[0];
            data.push([ lat, lng ]);
        }
        hexLayer.data(data);
    }

    generateData();



    function showPhoto (evt) {

        var photo = evt.layer.photo;
        $("section.viewing div.embeded-photo").empty().append("<img src='" + photo.url +"' /> <br/> <p class='text-center'> " +  photo.caption +" <p>");

    }


    var photoLayer1 = L.photo.cluster().on('mouseover', showPhoto);
    photoLayer1.add(photos1);

    var photoLayer2 = L.photo.cluster().on('mouseover', showPhoto);
    photoLayer2.add(photos2);

    var photoLayer3 = L.photo.cluster().on('mouseover', showPhoto);
    photoLayer3.add(photos3);


    var layers = {
        'checkin_marker' : [checkin_marker],
        'SR_marker1' : [SR_marker1],
        'SR_marker2' : [SR_marker2],
        'SR_marker3' : [SR_marker3],
        'ND_marker1' : [ND_marker1],

        'fb_symbol' : [fb_symbol],

        'camp_symbol' : [camp_symbol],

        'aquifer': [ L.geoJson.ajax('assets/aquifer.geojson', {
            color: '#ABD1E8',
            weight: 0,
            fillOpacity: 0.5,
            onEachFeature: function (feature, layer) {
                layer.bindTooltip('River: ' + feature.properties.NAME , {sticky: true, className: "feature-label", permanent: false, offset: [-10, -145]})
            }
        })
        ],
        'rivermain': [ L.geoJson.ajax('assets/rivermain.geojson',  {
            color: '#006080',
            weight: 5,
            fillOpacity: 0.3,
            opacity: 0.3
        })
        ],
        'riverwhole': [ L.geoJson.ajax('assets/riverwhole.geojson',  {
            color: '#ABD1E8',
            weight: 5,
            //fillOpacity: 0.8,
            opacity: 0.9
        })
        ],
        'camp': [ L.geoJson.ajax('assets/camp.geojson',  {
            color: '#006080',
            weight: 3000,
            opacity: 0.5
        })
        ],

        'pipeline': [ L.geoJson.ajax('assets/pipeline.geojson',  {
            lineCap: "butt",
            color: "#B51E1E",
            weight: 25,
            dashArray: "50 25",
            className: 'pipeline_pattern',
            opacity: 0.7
        })
        ],

        'standingrock' :  [L.geoJson.ajax('assets/StandingRock_outline.geojson',  {
            color: "orange",
            weight: 0,
            opacity: 1,
            fillOpacity: 0.5
        })
        ],

        'basemapmapbox' :[ L.mapboxGL({
            accessToken: 'pk.eyJ1IjoidGlhbnkiLCJhIjoiY2oyOGFyemhzMDBlZjJ3cWtydjBpMHZzdSJ9.KB4Qs2my3g97OeJSPLIHOw',
            style: 'assets/style.json',
            subdomains: 'abcd',
            maxZoom: 9,
            minZoom: 4
        })
        ],

        'Esri_NatGeoWorldMap' : [L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC',
            minZoom: 0,
            maxZoom: 16
        })],
        'Esri_WorldPhysical' : [L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; Source: US National Park Service',
            maxZoom: 8
        })],
        'CartoDB_Positron' : [ L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}@2x.png')],
        'PhotoLayers1': [photoLayer1],
        'PhotoLayers2': [photoLayer2],
        'PhotoLayers3': [photoLayer3],
        'hex':[hexLayer]
    };

    var scenes = {
        overview: {lat: 46.45, lng:-100.71, zoom: 7, name: 'Home',position: 'fullpage'},
        checkin: {lat: 46.45, lng:-100.71, zoom: 7,name: 'Info',position: 'fullpage'},
        map_intro: {lat: 46.45, lng:-103, zoom: 7,name: 'Standing Rock', layers:[ 'CartoDB_Positron', 'standingrock','PhotoLayers1']},
        map_pipeline: {lat: 46.45, lng:-100.82, zoom: 11,name: 'Pipeline', layers:['standingrock', 'aquifer',  'rivermain','riverwhole', 'pipeline', 'PhotoLayers2','ND_marker1','SR_marker2']},
        map_camp: {lat: 46.45, lng:-100.71,  zoom: 12,name: 'Camps', layers:['standingrock','aquifer', 'rivermain','riverwhole', 'pipeline', 'camp_symbol','ND_marker1','SR_marker3', 'PhotoLayers3']},
        map_hex: {lat: 47, lng:-103.5, zoom: 7,name: 'Spoofed Check-ins', layers:['CartoDB_Positron','checkin_marker']},
        map_hex_case1: {lat: 40, lng:-110, zoom: 4,name: 'Why Spoofing?', layers:[ 'CartoDB_Positron','fb_symbol']},
        map_hex_case2: {lat: 40, lng:-110, zoom: 4,name: 'Spatial and Semantic Explore', layers:[ 'CartoDB_Positron','hex']},
        end: {lat: 46.45, lng:-100.71, zoom: 7,name: 'End', position:'fullpage'}
    };

    $('.main').storymap({
        scenes: scenes,
        layers:layers,
        legend: false,
        scale:false,
        navwidget: true,
        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map('map', {zoomControl: false, dragging: false, scrollWheelZoom: false,maxZoom: 14}).setView([44.1347254, -122.7411479], 7);
            map.doubleClickZoom.disable();

            //test: returen lat lng
			/*map.on('click', function(e) {
			 alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng)
			 });*/

            miniMap = new L.Control.GlobeMiniMap({
                marker:'#B51E1E',
                position: 'bottomright'
            }).addTo(map);

            document.getElementsByClassName("leaflet-control-attribution")[0].style.visibility = "hidden";
            return map;

        }
    });


</script>
</body>
</html>
